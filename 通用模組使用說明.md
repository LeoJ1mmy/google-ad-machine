# é€šç”¨å»£å‘Šæ›¿æ›å™¨æ¨¡çµ„ä½¿ç”¨èªªæ˜

## æ¦‚è¿°

`base_ad_replacer.py` æ˜¯ä¸€å€‹é€šç”¨çš„å»£å‘Šæ›¿æ›å™¨åŸºç¤æ¨¡çµ„ï¼ŒåŒ…å«äº†æ‰€æœ‰é‡è¤‡çš„åŠŸèƒ½ï¼Œè®“æ‚¨å¯ä»¥è¼•é¬†ç‚ºæ–°ç¶²ç«™å‰µå»ºå»£å‘Šæ›¿æ›å™¨ã€‚

## ä¸»è¦åŠŸèƒ½

### 1. åŸºç¤åŠŸèƒ½ (BaseAdReplacer)
- âœ… **ç€è¦½å™¨è¨­ç½®**ï¼šè‡ªå‹•é…ç½® Chrome é©…å‹•
- âœ… **åœ–ç‰‡è¼‰å…¥**ï¼šè‡ªå‹•è¼‰å…¥ replace_image è³‡æ–™å¤¾ä¸­çš„åœ–ç‰‡
- âœ… **æŒ‰éˆ•æ¨£å¼**ï¼šæ”¯æ´ 4 ç¨®æŒ‰éˆ•æ¨£å¼ (dots, cross, adchoices, adchoices_dots)
- âœ… **å»£å‘Šæ›¿æ›**ï¼šçµ±ä¸€çš„å»£å‘Šæ›¿æ›é‚è¼¯
- âœ… **æˆªåœ–åŠŸèƒ½**ï¼šè‡ªå‹•æˆªåœ–ä¸¦åŠ å…¥é é¢æ¨™é¡Œ
- âœ… **é‚„åŸåŠŸèƒ½**ï¼šç°¡åŒ–çš„å»£å‘Šé‚„åŸé‚è¼¯
- âœ… **ä½ç½®è¨˜æ†¶**ï¼šé¿å…é‡è¤‡è™•ç†åŒä¸€ä½ç½®

### 2. éœ€è¦å¯¦ä½œçš„æ–¹æ³•
æ¯å€‹æ–°ç¶²ç«™åªéœ€è¦å¯¦ä½œä»¥ä¸‹å…©å€‹æ–¹æ³•ï¼š

#### `get_random_news_urls(self, base_url, count=5)`
- **åŠŸèƒ½**ï¼šç²å–è©²ç¶²ç«™çš„æ–°èé€£çµ
- **åƒæ•¸**ï¼š
  - `base_url`ï¼šç¶²ç«™é¦–é  URL
  - `count`ï¼šéœ€è¦ç²å–çš„é€£çµæ•¸é‡
- **è¿”å›**ï¼šæ–°èé€£çµåˆ—è¡¨

#### `scan_entire_page_for_ads(self, target_width, target_height)`
- **åŠŸèƒ½**ï¼šæƒæç¶²é å°‹æ‰¾ç¬¦åˆå°ºå¯¸çš„å»£å‘Š
- **åƒæ•¸**ï¼š
  - `target_width`ï¼šç›®æ¨™å»£å‘Šå¯¬åº¦
  - `target_height`ï¼šç›®æ¨™å»£å‘Šé«˜åº¦
- **è¿”å›**ï¼šç¬¦åˆæ¢ä»¶çš„å»£å‘Šå…ƒç´ åˆ—è¡¨

## ä½¿ç”¨æ–¹æ³•

### 1. å‰µå»ºæ–°ç¶²ç«™çš„å»£å‘Šæ›¿æ›å™¨

```python
from base_ad_replacer import BaseAdReplacer

class NewSiteAdReplacer(BaseAdReplacer):
    """æ–°ç¶²ç«™å»£å‘Šæ›¿æ›å™¨"""
    
    def __init__(self, headless=False):
        super().__init__(headless, site_prefix="newsite")  # è¨­å®šæˆªåœ–æª”æ¡ˆåå‰ç¶´
    
    def get_random_news_urls(self, base_url, count=5):
        """ç²å–æ–°ç¶²ç«™çš„æ–°èé€£çµ"""
        # å¯¦ä½œç²å–æ–°èé€£çµçš„é‚è¼¯
        pass
    
    def scan_entire_page_for_ads(self, target_width, target_height):
        """æƒææ–°ç¶²ç«™çš„å»£å‘Š"""
        # å¯¦ä½œæƒæå»£å‘Šçš„é‚è¼¯
        pass
```

### 2. ç¯„ä¾‹ï¼šè‡ªç”±æ™‚å ±

```python
class LtnAdReplacer(BaseAdReplacer):
    def __init__(self, headless=False):
        super().__init__(headless, site_prefix="ltn")
    
    def get_random_news_urls(self, base_url, count=5):
        # ä½¿ç”¨ CSS é¸æ“‡å™¨ç²å–æ–°èé€£çµ
        link_selectors = [
            'a[href*="/article/"]',
            'a[href*="/news/"]',
            # ... æ›´å¤šé¸æ“‡å™¨
        ]
        # å¯¦ä½œé‚è¼¯...
    
    def scan_entire_page_for_ads(self, target_width, target_height):
        # æƒææ‰€æœ‰å¯è¦‹å…ƒç´ 
        # æª¢æŸ¥å°ºå¯¸åŒ¹é…
        # é©—è­‰æ˜¯å¦ç‚ºå»£å‘Š
        # å¯¦ä½œé‚è¼¯...
```

### 3. ç¯„ä¾‹ï¼šYahoo æ–°è

```python
class YahooAdReplacer(BaseAdReplacer):
    def __init__(self, headless=False):
        super().__init__(headless, site_prefix="yahoo")
    
    def get_random_news_urls(self, base_url, count=5):
        # Yahoo ç‰¹å®šçš„æ–°èé€£çµç²å–é‚è¼¯
        pass
    
    def scan_entire_page_for_ads(self, target_width, target_height):
        # Yahoo ç‰¹å®šçš„å»£å‘Šæƒæé‚è¼¯
        pass
```

## é…ç½®è¨­å®š

### config.py è¨­å®š
```python
# æŒ‰éˆ•æ¨£å¼è¨­å®š
BUTTON_STYLE = "adchoices_dots"  # å¯é¸: "dots", "cross", "adchoices", "adchoices_dots"

# æˆªåœ–è¨­å®š
SCREENSHOT_COUNT = 30
SCREENSHOT_FOLDER = "screenshots"

# ç¶²ç«™è¨­å®š
BASE_URL = "https://your-site.com"
NEWS_COUNT = 20
```

## æª”æ¡ˆçµæ§‹

```
project/
â”œâ”€â”€ base_ad_replacer.py          # åŸºç¤æ¨¡çµ„
â”œâ”€â”€ config.py                    # è¨­å®šæª”
â”œâ”€â”€ ad_replacer_new.py          # è‡ªç”±æ™‚å ± (æ–°ç‰ˆæœ¬)
â”œâ”€â”€ yahoo_replace_new.py        # Yahoo æ–°è (æ–°ç‰ˆæœ¬)
â”œâ”€â”€ udn_replace_new.py          # è¯åˆå ± (æ–°ç‰ˆæœ¬)
â”œâ”€â”€ replace_image/              # æ›¿æ›åœ–ç‰‡è³‡æ–™å¤¾
â”œâ”€â”€ screenshots/                # æˆªåœ–è¼¸å‡ºè³‡æ–™å¤¾
â””â”€â”€ é€šç”¨æ¨¡çµ„ä½¿ç”¨èªªæ˜.md         # æœ¬èªªæ˜æ–‡ä»¶
```

## å„ªå‹¢

### 1. ä»£ç¢¼é‡ç”¨
- æ‰€æœ‰é€šç”¨åŠŸèƒ½éƒ½åœ¨åŸºç¤æ¨¡çµ„ä¸­
- æ–°ç¶²ç«™åªéœ€è¦å¯¦ä½œ 2 å€‹æ–¹æ³•
- æ¸›å°‘é‡è¤‡ä»£ç¢¼

### 2. çµ±ä¸€åŠŸèƒ½
- çµ±ä¸€çš„æˆªåœ–å‘½åæ ¼å¼
- çµ±ä¸€çš„é‚„åŸé‚è¼¯
- çµ±ä¸€çš„æŒ‰éˆ•æ¨£å¼

### 3. æ˜“æ–¼ç¶­è­·
- åŠŸèƒ½ä¿®æ”¹åªéœ€è¦æ”¹åŸºç¤æ¨¡çµ„
- æ‰€æœ‰ç¶²ç«™è‡ªå‹•ç²å¾—æ–°åŠŸèƒ½
- æ¸…æ™°çš„ä»£ç¢¼çµæ§‹

### 4. å¿«é€Ÿé–‹ç™¼
- æ–°ç¶²ç«™é–‹ç™¼æ™‚é–“å¤§å¹…ç¸®çŸ­
- åªéœ€è¦å°ˆæ³¨æ–¼ç¶²ç«™ç‰¹å®šçš„é‚è¼¯
- æ¸›å°‘éŒ¯èª¤å’Œèª¿è©¦æ™‚é–“

## é·ç§»æŒ‡å—

### å¾èˆŠç‰ˆæœ¬é·ç§»åˆ°æ–°ç‰ˆæœ¬

1. **å‰µå»ºæ–°çš„é¡åˆ¥**ï¼š
   ```python
   from base_ad_replacer import BaseAdReplacer
   
   class YourSiteAdReplacer(BaseAdReplacer):
       def __init__(self, headless=False):
           super().__init__(headless, site_prefix="yoursite")
   ```

2. **å¯¦ä½œå¿…è¦æ–¹æ³•**ï¼š
   - è¤‡è£½ `get_random_news_urls` æ–¹æ³•
   - è¤‡è£½ `scan_entire_page_for_ads` æ–¹æ³•

3. **ç§»é™¤é‡è¤‡ä»£ç¢¼**ï¼š
   - åˆªé™¤é‡è¤‡çš„æˆªåœ–ã€é‚„åŸã€æŒ‰éˆ•ç­‰ä»£ç¢¼
   - ä¿ç•™ç¶²ç«™ç‰¹å®šçš„é‚è¼¯

4. **æ¸¬è©¦æ–°ç‰ˆæœ¬**ï¼š
   - ç¢ºä¿åŠŸèƒ½æ­£å¸¸é‹ä½œ
   - æª¢æŸ¥æˆªåœ–å‘½åæ ¼å¼
   - é©—è­‰é‚„åŸåŠŸèƒ½

## æ³¨æ„äº‹é …

1. **ç¶²ç«™ç‰¹å®šé‚è¼¯**ï¼šæ¯å€‹ç¶²ç«™çš„å»£å‘Šçµæ§‹å¯èƒ½ä¸åŒï¼Œéœ€è¦èª¿æ•´æƒæé‚è¼¯
2. **é¸æ“‡å™¨æ›´æ–°**ï¼šç¶²ç«™çµæ§‹è®ŠåŒ–æ™‚éœ€è¦æ›´æ–° CSS é¸æ“‡å™¨
3. **éŒ¯èª¤è™•ç†**ï¼šå»ºè­°åŠ å…¥é©ç•¶çš„éŒ¯èª¤è™•ç†æ©Ÿåˆ¶
4. **æ•ˆèƒ½å„ªåŒ–**ï¼šå°æ–¼å¤§å‹ç¶²ç«™ï¼Œå¯èƒ½éœ€è¦å„ªåŒ–æƒææ•ˆèƒ½

## æ”¯æ´çš„ç¶²ç«™é¡å‹

- âœ… æ–°èç¶²ç«™
- âœ… éƒ¨è½æ ¼ç¶²ç«™
- âœ… å…§å®¹ç¶²ç«™
- âœ… ä»»ä½•åŒ…å«å»£å‘Šçš„ç¶²ç«™

## æœªä¾†æ“´å±•

- ğŸ”„ æ”¯æ´æ›´å¤šæŒ‰éˆ•æ¨£å¼
- ğŸ”„ è‡ªå‹•å»£å‘Šè­˜åˆ¥
- ğŸ”„ å¤šç¶²ç«™ä¸¦è¡Œè™•ç†
- ğŸ”„ æ›´æ™ºèƒ½çš„é‚„åŸæ©Ÿåˆ¶ 